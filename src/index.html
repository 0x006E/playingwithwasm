<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <title>Document</title>
</head>

<body>
  <canvas id="canvas"></canvas>
  <script id="worker" type="text/worker-js">
    self.onmessage = function (e) {
      function draw(x, y, colors = [0, 0, 0]) {
        var isLittleEndian = e.data.isLittleEndian;
        if (isLittleEndian) {
          data[y * canvasWidth + x] =
            (255 << 24) | // alpha
            (colors[2] << 16) | // blue
            (colors[1] << 8) | // green
            colors[0]; // red
        } else {
          data[y * canvasWidth + x] =
            (colors[0] << 24) | // red
            (colors[1] << 16) | // green
            (colors[2] << 8) | // blue
            255; // alpha
        }
      }
      console.log(e.data)
      if (e.data.msg === "start") {
        ctx = e.data.canvas.getContext('2d')
        canvasWidth = e.data.canvas.width;
        canvasHeight = e.data.canvas.height;
        var imageData = ctx.getImageData(0, 0, canvasWidth, canvasHeight);

        var buf = new ArrayBuffer(imageData.data.length);
        var data = new Uint32Array(buf);
        for (var i = 0; i < canvasWidth; i++) {
          draw(i, i, [234, 245, 155]);
          imageData.data.set(buf8);
          ctx.putImageData(imageData, 0, 0);
        }
        break;
      }
    }

  </script>
  <script src="./main.js"></script>
  </script>
</body>

</html>